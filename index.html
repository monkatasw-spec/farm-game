<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–§–µ—Ä–º–∞ –û–Ω–ª–∞–π–Ω</title>

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:url("grass.JPG") repeat;
  background-size:220px 220px;
  font-family:Arial, sans-serif;
}

#game{
  background:rgba(0,0,0,0.25);
  backdrop-filter:blur(4px);
  padding:20px;
  border-radius:22px;
  width:95%;
  max-width:420px;
}

#header{
  text-align:center;
  color:white;
  margin-bottom:16px;
}

#money{
  opacity:0.9;
}

/* –ü–û–õ–ï–¢–ê */
#fields{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:14px;
}

.field{
  aspect-ratio:1/1;
  background:linear-gradient(#6b4a2e,#4b2f18);
  border-radius:16px;
  box-shadow:
    inset 0 4px 6px rgba(255,255,255,0.15),
    inset 0 -6px 8px rgba(0,0,0,0.45),
    0 6px 10px rgba(0,0,0,0.4);
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:36px;
  cursor:pointer;
  transition:filter .3s;
}

.field.growing{ filter:brightness(0.85); }
.field.ready{ filter:brightness(1.3); }

/* –ë–£–¢–û–ù–ò */
#actions{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:16px;
}

button{
  padding:10px 14px;
  border:none;
  border-radius:12px;
  font-size:16px;
  cursor:pointer;
}
</style>
</head>

<body>

<div id="game">
  <div id="header">
    <h2>üåæ –§–µ—Ä–º–∞ –û–Ω–ª–∞–π–Ω</h2>
    <div id="money">üí∞ <span id="coins">0</span></div>
  </div>

  <div id="fields"></div>

  <div id="actions">
    <button onclick="selectCrop('wheat')">üåæ –ü—à–µ–Ω–∏—Ü–∞</button>
    <button onclick="selectCrop('carrot')">ü•ï –ú–æ—Ä–∫–æ–≤</button>
    <button onclick="selectCrop('tomato')">üçÖ –î–æ–º–∞—Ç–∏</button>
  </div>
</div>

<script>
/* ===== –ö–£–õ–¢–£–†–ò ===== */
const crops = {
  wheat:  { icon:'üåæ', cost:10, time:3000, reward:25 },
  carrot: { icon:'ü•ï', cost:15, time:6000, reward:50 },
  tomato: { icon:'üçÖ', cost:20, time:9000, reward:90 }
};

const fieldsEl = document.getElementById("fields");
const coinsEl = document.getElementById("coins");

let selected = null;

/* ===== SAVE / LOAD ===== */
let save = JSON.parse(localStorage.getItem("farm_save")) || {
  coins: 500,
  fields: Array(12).fill(null)
};

coinsEl.textContent = save.coins;

/* ===== –°–™–ó–î–ê–í–ê–ù–ï –ù–ê –ü–û–õ–ï–¢–ê ===== */
save.fields.forEach((data, index)=>{
  const f = document.createElement("div");
  f.className = "field";
  f.onclick = ()=>handleField(f, index);
  fieldsEl.appendChild(f);

  if(data){
    f.textContent = crops[data.crop].icon;
    f.dataset.crop = data.crop;

    const elapsed = Date.now() - data.plantedAt;
    if(elapsed >= crops[data.crop].time){
      f.dataset.state="ready";
      f.classList.add("ready");
    }else{
      f.dataset.state="growing";
      f.classList.add("growing");
      setTimeout(()=>{
        f.dataset.state="ready";
        f.classList.remove("growing");
        f.classList.add("ready");
        saveGame();
      }, crops[data.crop].time - elapsed);
    }
  }else{
    f.dataset.state="empty";
  }
});

/* ===== –ò–ó–ë–û–† –ù–ê –ö–£–õ–¢–£–†–ê ===== */
function selectCrop(type){
  selected = type;
}

/* ===== –õ–û–ì–ò–ö–ê –ù–ê –ü–û–õ–ï–¢–û ===== */
function handleField(field, index){
  if(field.dataset.state==="empty"){
    plant(field, index);
  }else if(field.dataset.state==="ready"){
    harvest(field, index);
  }
}

/* ===== –ó–ê–°–ê–ñ–î–ê–ù–ï ===== */
function plant(field, index){
  if(!selected) return;

  const crop = crops[selected];
  if(save.coins < crop.cost) return;

  save.coins -= crop.cost;
  coinsEl.textContent = save.coins;

  field.textContent = crop.icon;
  field.dataset.state="growing";
  field.dataset.crop=selected;
  field.classList.add("growing");

  save.fields[index] = {
    crop:selected,
    plantedAt:Date.now()
  };

  saveGame();

  setTimeout(()=>{
    field.dataset.state="ready";
    field.classList.remove("growing");
    field.classList.add("ready");
    saveGame();
  }, crop.time);
}

/* ===== –û–ë–ò–†–ê–ù–ï ===== */
function harvest(field, index){
  const crop = crops[field.dataset.crop];

  save.coins += crop.reward;
  coinsEl.textContent = save.coins;

  field.textContent="";
  field.dataset.state="empty";
  field.dataset.crop="";
  field.classList.remove("ready");

  save.fields[index] = null;
  saveGame();
}

/* ===== –ó–ê–ü–ê–ó–í–ê–ù–ï ===== */
function saveGame(){
  localStorage.setItem("farm_save", JSON.stringify(save));
}
</script>

</body>
</html>
