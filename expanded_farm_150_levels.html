<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>Ð¤ÐµÑ€Ð¼Ð° ÐžÐ½Ð»Ð°Ð¹Ð½</title>
<style>
body{
  margin:0;
  font-family:sans-serif;
  background:linear-gradient(#7ec850,#5fa63a);
  text-align:center;
}
h2{margin:10px;color:#2f4f1f;}
#top{font-size:18px;margin-bottom:10px;}
#farm{
  margin:20px auto;
  display:grid;
  grid-template-columns:repeat(6,80px);
  gap:10px;
}
.plot{
  width:80px;height:80px;
  background:linear-gradient(#7a4a1e,#5a3512);
  border-radius:10px;
  box-shadow:inset 0 4px 6px rgba(0,0,0,.3);
  display:flex;align-items:center;justify-content:center;
  font-size:32px;cursor:pointer;
}
.plot.growing{animation:pulse 1.5s infinite;}
.plot.ready{box-shadow:0 0 10px gold;}
@keyframes pulse{
  0%{transform:scale(1);}
  50%{transform:scale(1.05);}
  100%{transform:scale(1);}
}
#menu{margin:10px;}
.seed{
  display:inline-block;
  padding:6px 10px;
  margin:4px;
  background:#fff;
  border-radius:8px;
  cursor:pointer;
  border:2px solid transparent;
}
.seed.active{border-color:green;background:#eaffea;}
</style>
</head>
<body>

<h2>ðŸŒ¾ Ð¤ÐµÑ€Ð¼Ð° ÐžÐ½Ð»Ð°Ð¹Ð½</h2>
<div id="top">ðŸ’° <span id="coins">0</span></div>

<div id="farm"></div>
<div id="menu"></div>

<script>
// ---------- DATA ----------
const seeds = [
 {id:0,name:"Ð¿ÑˆÐµÐ½Ð¸Ñ†Ð°",emoji:["ðŸŒ±","ðŸŒ¿","ðŸŒ¾"],cost:5,reward:10,time:3000},
 {id:1,name:"Ð¼Ð¾Ñ€ÐºÐ¾Ð²",emoji:["ðŸŒ±","ðŸ¥•","ðŸ¥•"],cost:15,reward:25,time:4000},
 {id:2,name:"Ð´Ð¾Ð¼Ð°Ñ‚Ð¸",emoji:["ðŸŒ±","ðŸ…","ðŸ…"],cost:30,reward:50,time:5000}
];

// ---------- LOAD SAVE ----------
let state = JSON.parse(localStorage.getItem("farmSave")) || {
 coins:50,
 plots:Array(36).fill(null) // null Ð¸Ð»Ð¸ {seedId, plantedAt}
};

let selectedSeed = seeds[0];

const farm = document.getElementById("farm");
const menu = document.getElementById("menu");
const coinsEl = document.getElementById("coins");

// ---------- SAVE ----------
function saveGame(){
 localStorage.setItem("farmSave", JSON.stringify(state));
}

// ---------- UI ----------
function updateCoins(){
 coinsEl.textContent = state.coins;
}

// ---------- CREATE FARM ----------
function createFarm(){
 farm.innerHTML="";
 state.plots.forEach((p,i)=>{
  const d=document.createElement("div");
  d.className="plot";

  if(p){
    restorePlot(d,p,i);
  } else {
    d.onclick=()=>plant(d,i);
  }

  farm.appendChild(d);
 });
}

// ---------- MENU ----------
seeds.forEach((s,i)=>{
 const b=document.createElement("span");
 b.className="seed"+(i===0?" active":"");
 b.textContent=s.emoji[2]+" "+s.name;
 b.onclick=()=>{
  selectedSeed=s;
  document.querySelectorAll(".seed").forEach(x=>x.classList.remove("active"));
  b.classList.add("active");
 };
 menu.appendChild(b);
});

// ---------- PLANT ----------
function plant(plot,index){
 if(state.plots[index]) return;
 if(state.coins < selectedSeed.cost){
  alert("ÐÑÐ¼Ð°Ñˆ Ð¼Ð¾Ð½ÐµÑ‚Ð¸");
  return;
 }

 state.coins -= selectedSeed.cost;
 state.plots[index] = {
  seedId:selectedSeed.id,
  plantedAt:Date.now()
 };

 saveGame();
 updateCoins();
 growPlot(plot,index);
}

// ---------- GROW ----------
function growPlot(plot,index){
 const data = state.plots[index];
 const seed = seeds[data.seedId];
 const elapsed = Date.now() - data.plantedAt;

 plot.className="plot growing";
 plot.textContent=seed.emoji[0];

 if(elapsed >= seed.time){
  readyPlot(plot,index);
  return;
 }

 if(elapsed >= seed.time/2){
  plot.textContent=seed.emoji[1];
 }

 setTimeout(()=>{
  if(state.plots[index]) plot.textContent=seed.emoji[1];
 }, Math.max(0, seed.time/2 - elapsed));

 setTimeout(()=>{
  if(state.plots[index]) readyPlot(plot,index);
 }, Math.max(0, seed.time - elapsed));
}

// ---------- READY ----------
function readyPlot(plot,index){
 const seed = seeds[state.plots[index].seedId];
 plot.className="plot ready";
 plot.textContent=seed.emoji[2];

 plot.onclick=()=>{
  state.coins += seed.reward;
  state.plots[index]=null;
  saveGame();
  updateCoins();
  plot.className="plot";
  plot.textContent="";
  plot.onclick=()=>plant(plot,index);
 };
}

// ---------- RESTORE ----------
function restorePlot(plot,data,index){
 const seed = seeds[data.seedId];
 const elapsed = Date.now() - data.plantedAt;

 if(elapsed >= seed.time){
  readyPlot(plot,index);
 } else {
  growPlot(plot,index);
 }
}

// ---------- START ----------
updateCoins();
createFarm();
</script>
</body>
</html>
