<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>Ð¤ÐµÑ€Ð¼Ð° ÐžÐ½Ð»Ð°Ð¹Ð½</title>
<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,0.08), transparent 40%),
    radial-gradient(circle at 80% 70%, rgba(255,255,255,0.06), transparent 45%),
    #7ecb6f;
  text-align:center;
}

h2{
  margin:12px 0 6px;
  color:#2f5d2f;
}

#top{
  font-size:18px;
  margin-bottom:10px;
  color:#1f3d1f;
}

#game{
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* FARM */
#farm{
  display:grid;
  grid-template-columns:repeat(6,78px);
  gap:10px;
  padding:14px;
  background:#6fbf5a;
  border-radius:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.2);
}

/* PLOT */
.plot{
  width:78px;
  height:78px;
  background:#8b5a2b;
  border-radius:12px;
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.15),
    inset 0 -2px 4px rgba(0,0,0,.25),
    0 3px 5px rgba(0,0,0,.25);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:30px;
  cursor:pointer;
  transition:transform .15s ease;
}

.plot:active{
  transform:scale(0.95);
}

/* STATES */
.plot.growing{
  animation:grow 2s ease-in-out infinite;
}

.plot.ready{
  box-shadow:
    inset 0 2px 0 rgba(255,255,255,.2),
    inset 0 -2px 4px rgba(0,0,0,.3),
    0 0 0 2px rgba(255,215,0,.7);
}

@keyframes grow{
  0%{transform:scale(1);}
  50%{transform:scale(1.05);}
  100%{transform:scale(1);}
}

/* HARVEST */
.harvest{
  animation:harvest .35s ease-out;
}

@keyframes harvest{
  0%{transform:scale(1);}
  60%{transform:scale(1.15);}
  100%{transform:scale(0);}
}

/* COIN */
.coin-float{
  position:absolute;
  font-size:14px;
  animation:coinUp .9s ease-out forwards;
  pointer-events:none;
}

@keyframes coinUp{
  0%{opacity:1;transform:translateY(0);}
  100%{opacity:0;transform:translateY(-25px);}
}

/* MENU */
#menu{
  margin-top:12px;
}

.seed{
  display:inline-block;
  padding:6px 10px;
  margin:4px;
  background:#fff;
  border-radius:10px;
  cursor:pointer;
  border:2px solid transparent;
  font-size:14px;
}

.seed.active{
  border-color:#3a8f3a;
  background:#e8f6e8;
}
</style>
</head>
<body>

<h2>ðŸŒ¾ Ð¤ÐµÑ€Ð¼Ð° ÐžÐ½Ð»Ð°Ð¹Ð½</h2>
<div id="top">ðŸ’° <span id="coins">0</span></div>

<div id="game">
  <div id="farm"></div>
  <div id="menu"></div>
</div>

<script>
const seeds=[
 {id:0,name:"ÐŸÑˆÐµÐ½Ð¸Ñ†Ð°",emoji:["ðŸŒ±","ðŸŒ¿","ðŸŒ¾"],cost:5,reward:10,time:3000},
 {id:1,name:"ÐœÐ¾Ñ€ÐºÐ¾Ð²Ð¸",emoji:["ðŸŒ±","ðŸ¥•","ðŸ¥•"],cost:15,reward:25,time:4000},
 {id:2,name:"Ð”Ð¾Ð¼Ð°Ñ‚Ð¸",emoji:["ðŸŒ±","ðŸ…","ðŸ…"],cost:30,reward:50,time:5000}
];

let state=JSON.parse(localStorage.getItem("farmSave"))||{
 coins:50,
 plots:Array(36).fill(null)
};

let selectedSeed=seeds[0];

const farm=document.getElementById("farm");
const menu=document.getElementById("menu");
const coinsEl=document.getElementById("coins");

function saveGame(){
 localStorage.setItem("farmSave",JSON.stringify(state));
}

function updateCoins(){
 coinsEl.textContent=state.coins;
}

function createFarm(){
 farm.innerHTML="";
 state.plots.forEach((p,i)=>{
  const d=document.createElement("div");
  d.className="plot";
  if(p){
    restorePlot(d,p,i);
  }else{
    d.onclick=()=>plant(d,i);
  }
  farm.appendChild(d);
 });
}

seeds.forEach((s,i)=>{
 const b=document.createElement("span");
 b.className="seed"+(i===0?" active":"");
 b.textContent=s.emoji[2]+" "+s.name;
 b.onclick=()=>{
  selectedSeed=s;
  document.querySelectorAll(".seed").forEach(x=>x.classList.remove("active"));
  b.classList.add("active");
 };
 menu.appendChild(b);
});

function plant(plot,index){
 if(state.plots[index]) return;
 if(state.coins<selectedSeed.cost){alert("ÐÑÐ¼Ð°Ñˆ Ð¼Ð¾Ð½ÐµÑ‚Ð¸");return;}

 state.coins-=selectedSeed.cost;
 state.plots[index]={seedId:selectedSeed.id,plantedAt:Date.now()};
 saveGame();
 updateCoins();
 growPlot(plot,index);
}

function growPlot(plot,index){
 const data=state.plots[index];
 const seed=seeds[data.seedId];
 const elapsed=Date.now()-data.plantedAt;

 plot.className="plot growing";
 plot.textContent=seed.emoji[0];

 if(elapsed>=seed.time){
  readyPlot(plot,index);
  return;
 }

 if(elapsed>=seed.time/2){
  plot.textContent=seed.emoji[1];
 }

 setTimeout(()=>{ if(state.plots[index]) plot.textContent=seed.emoji[1]; },
   Math.max(0,seed.time/2-elapsed));

 setTimeout(()=>{ if(state.plots[index]) readyPlot(plot,index); },
   Math.max(0,seed.time-elapsed));
}

function readyPlot(plot,index){
 const seed=seeds[state.plots[index].seedId];
 plot.className="plot ready";
 plot.textContent=seed.emoji[2];

 plot.onclick=()=>{
  plot.classList.add("harvest");

  const coin=document.createElement("div");
  coin.className="coin-float";
  coin.textContent="+"+seed.reward+" ðŸ’°";
  plot.appendChild(coin);

  setTimeout(()=>{
    state.coins+=seed.reward;
    state.plots[index]=null;
    saveGame();
    updateCoins();
    plot.className="plot";
    plot.textContent="";
    plot.onclick=()=>plant(plot,index);
  },350);
 };
}

function restorePlot(plot,data,index){
 const seed=seeds[data.seedId];
 const elapsed=Date.now()-data.plantedAt;
 if(elapsed>=seed.time){
  readyPlot(plot,index);
 }else{
  growPlot(plot,index);
 }
}

updateCoins();
createFarm();
</script>
</body>
</html>
