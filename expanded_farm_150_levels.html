<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>Ð¤ÐµÑ€Ð¼Ð° ÐžÐ½Ð»Ð°Ð¹Ð½</title>
<style>
body{
  margin:0;
  font-family:sans-serif;
  background:
    repeating-linear-gradient(
      45deg,
      #6fbf4b,
      #6fbf4b 10px,
      #68b444 10px,
      #68b444 20px
    );
  text-align:center;
}

h2{
  margin:10px 0;
  color:#2f4f1f;
}

#top{
  font-size:18px;
  margin-bottom:10px;
}

#game{
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* --- FARM GRID --- */
#farm{
  display:grid;
  grid-template-columns:repeat(6,80px);
  gap:12px;
  padding:14px;
  background:rgba(255,255,255,0.15);
  border-radius:18px;
  box-shadow:0 8px 20px rgba(0,0,0,.2);
}

/* --- PLOT --- */
.plot{
  width:80px;
  height:80px;
  border-radius:10px;
  position:relative;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:30px;
  overflow:hidden;
  background:
    repeating-linear-gradient(
      90deg,
      #7b4a1e,
      #7b4a1e 6px,
      #6a3f18 6px,
      #6a3f18 12px
    );
  box-shadow:
    inset 0 2px 3px rgba(255,255,255,.2),
    inset 0 -3px 4px rgba(0,0,0,.3),
    0 4px 6px rgba(0,0,0,.25);
}

/* slight variation per plot */
.plot:nth-child(even){
  filter:brightness(1.03);
}
.plot:nth-child(odd){
  filter:brightness(0.97);
}

/* --- STATES --- */
.plot.growing{
  animation:growPulse 1.6s infinite;
}

.plot.ready{
  animation:wind 3s ease-in-out infinite;
  box-shadow:
    inset 0 2px 3px rgba(255,255,255,.25),
    inset 0 -3px 4px rgba(0,0,0,.35),
    0 0 10px rgba(255,215,0,.8);
}

@keyframes growPulse{
  0%{transform:scale(1);}
  50%{transform:scale(1.06);}
  100%{transform:scale(1);}
}

@keyframes wind{
  0%{transform:rotate(0deg);}
  50%{transform:rotate(2deg);}
  100%{transform:rotate(0deg);}
}

/* --- HARVEST --- */
.harvest{
  animation:harvest 0.4s ease-out;
}

@keyframes harvest{
  0%{transform:scale(1);}
  50%{transform:scale(1.2);}
  100%{transform:scale(0);}
}

/* --- COIN --- */
.coin-float{
  position:absolute;
  font-size:14px;
  animation:coinUp 1s ease-out forwards;
  pointer-events:none;
}

@keyframes coinUp{
  0%{opacity:1;transform:translateY(0);}
  100%{opacity:0;transform:translateY(-30px);}
}

/* --- MENU --- */
#menu{
  margin-top:14px;
}

.seed{
  display:inline-block;
  padding:6px 10px;
  margin:4px;
  background:#fff;
  border-radius:8px;
  cursor:pointer;
  border:2px solid transparent;
}

.seed.active{
  border-color:green;
  background:#eaffea;
}
</style>
</head>
<body>

<h2>ðŸŒ¾ Ð¤ÐµÑ€Ð¼Ð° ÐžÐ½Ð»Ð°Ð¹Ð½</h2>
<div id="top">ðŸ’° <span id="coins">0</span></div>

<div id="game">
  <div id="farm"></div>
  <div id="menu"></div>
</div>

<script>
const seeds=[
 {id:0,name:"Ð¿ÑˆÐµÐ½Ð¸Ñ†Ð°",emoji:["ðŸŒ±","ðŸŒ¿","ðŸŒ¾"],cost:5,reward:10,time:3000},
 {id:1,name:"Ð¼Ð¾Ñ€ÐºÐ¾Ð²",emoji:["ðŸŒ±","ðŸ¥•","ðŸ¥•"],cost:15,reward:25,time:4000},
 {id:2,name:"Ð´Ð¾Ð¼Ð°Ñ‚Ð¸",emoji:["ðŸŒ±","ðŸ…","ðŸ…"],cost:30,reward:50,time:5000}
];

let state=JSON.parse(localStorage.getItem("farmSave"))||{
 coins:50,
 plots:Array(36).fill(null)
};

let selectedSeed=seeds[0];

const farm=document.getElementById("farm");
const menu=document.getElementById("menu");
const coinsEl=document.getElementById("coins");

function saveGame(){
 localStorage.setItem("farmSave",JSON.stringify(state));
}

function updateCoins(){
 coinsEl.textContent=state.coins;
}

function createFarm(){
 farm.innerHTML="";
 state.plots.forEach((p,i)=>{
  const d=document.createElement("div");
  d.className="plot";
  if(p){
    restorePlot(d,p,i);
  }else{
    d.onclick=()=>plant(d,i);
  }
  farm.appendChild(d);
 });
}

seeds.forEach((s,i)=>{
 const b=document.createElement("span");
 b.className="seed"+(i===0?" active":"");
 b.textContent=s.emoji[2]+" "+s.name;
 b.onclick=()=>{
  selectedSeed=s;
  document.querySelectorAll(".seed").forEach(x=>x.classList.remove("active"));
  b.classList.add("active");
 };
 menu.appendChild(b);
});

function plant(plot,index){
 if(state.plots[index]) return;
 if(state.coins<selectedSeed.cost){alert("ÐÑÐ¼Ð°Ñˆ Ð¼Ð¾Ð½ÐµÑ‚Ð¸");return;}

 state.coins-=selectedSeed.cost;
 state.plots[index]={seedId:selectedSeed.id,plantedAt:Date.now()};
 saveGame();
 updateCoins();
 growPlot(plot,index);
}

function growPlot(plot,index){
 const data=state.plots[index];
 const seed=seeds[data.seedId];
 const elapsed=Date.now()-data.plantedAt;

 plot.className="plot growing";
 plot.textContent=seed.emoji[0];

 if(elapsed>=seed.time){
  readyPlot(plot,index);
  return;
 }

 if(elapsed>=seed.time/2){
  plot.textContent=seed.emoji[1];
 }

 setTimeout(()=>{ if(state.plots[index]) plot.textContent=seed.emoji[1]; },
   Math.max(0,seed.time/2-elapsed));

 setTimeout(()=>{ if(state.plots[index]) readyPlot(plot,index); },
   Math.max(0,seed.time-elapsed));
}

function readyPlot(plot,index){
 const seed=seeds[state.plots[index].seedId];
 plot.className="plot ready";
 plot.textContent=seed.emoji[2];

 plot.onclick=()=>{
  plot.classList.add("harvest");

  const coin=document.createElement("div");
  coin.className="coin-float";
  coin.textContent="+"+seed.reward+" ðŸ’°";
  plot.appendChild(coin);

  setTimeout(()=>{
    state.coins+=seed.reward;
    state.plots[index]=null;
    saveGame();
    updateCoins();
    plot.className="plot";
    plot.textContent="";
    plot.onclick=()=>plant(plot,index);
  },400);
 };
}

function restorePlot(plot,data,index){
 const seed=seeds[data.seedId];
 const elapsed=Date.now()-data.plantedAt;
 if(elapsed>=seed.time){
  readyPlot(plot,index);
 }else{
  growPlot(plot,index);
 }
}

updateCoins();
createFarm();
</script>
</body>
</html>
